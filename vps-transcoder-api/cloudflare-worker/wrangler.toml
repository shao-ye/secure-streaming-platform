name = "yoyo-streaming-worker"
main = "src/index.js"
compatibility_date = "2023-12-01"

[[kv_namespaces]]
binding = "YOYO_USER_DB"
id = "edafbcf1042147f9b52f0fc4b5c37543"
preview_id = "f36b78f5fd4d493aa567f9e8abf68348"

# R2存储桶配置 - 登录日志存储
[[r2_buckets]]
binding = "LOGIN_LOGS_BUCKET"
bucket_name = "yoyo-login-logs"

# R2存储桶配置 - 代理测试历史
[[r2_buckets]]
binding = "PROXY_TEST_HISTORY"
bucket_name = "proxy-test-history"

# 路由配置
[[routes]]
pattern = "yoyoapi.5202021.xyz/*"
zone_name = "5202021.xyz"

# Durable Objects（如果需要）
# [[durable_objects.bindings]]
# name = "STREAMING_SESSIONS"
# class_name = "StreamingSession"

# 开发环境配置
[dev]
port = 8787
local_protocol = "https"
upstream_protocol = "https"

# 开发环境配置
[env.development]
vars = { ENVIRONMENT = "development" }

# 生产环境配置
[env.production]
[env.production.vars]
ENVIRONMENT = "production"
VPS_API_URL = "https://yoyo-vps.5202021.xyz"
VPS_HLS_URL = "https://yoyo-vps.5202021.xyz"
VPS_ENABLED = "true"
VPS_API_KEY = "85da076ae24b028b3d1ea1884e6b13c5afe34488be0f8d39a05fbbf26d23e938"
# 隧道优化配置
TUNNEL_ENABLED = "true"
# 隧道优化部署配置 (需要配置API凭据以启用自动部署)
CLOUDFLARE_ACCOUNT_ID = "788ac44febb9c425b4e5f14bff8bab1d"
CLOUDFLARE_API_TOKEN = "18ENKstNPG2_8-3tJFEzzo_YLZly698Y_rRtmpWq"
WORKER_NAME = "yoyo-streaming-worker-production"

[[env.production.kv_namespaces]]
binding = "YOYO_USER_DB"
id = "edafbcf1042147f9b52f0fc4b5c37543"
[[env.production.r2_buckets]]
binding = "LOGIN_LOGS_BUCKET"
bucket_name = "yoyo-login-logs"

[[env.production.r2_buckets]]
binding = "PROXY_TEST_HISTORY"
bucket_name = "proxy-test-history"
